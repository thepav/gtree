function tree_count_func(e){return e.length}function leaf_area_func(e){var t=0;for(f=0;f<e.length;f++)fattr=e[f].attributes,t+=parseInt(fattr.CanopyRadiusFT)*parseInt(fattr.CanopyRadiusFT)*Math.PI;return t}function total_height_func(e){var t=0;for(f=0;f<e.length;f++)fattr=e[f].attributes,t+=parseInt(fattr.TOTHT);return t}function distribution_func(e){var t={};for(f=0;f<e.length;f++){var n=e[f].attributes,r=n.COMMONNAME;null==t[r]?t[r]=1:t[r]+=1}return t}function species_func(e){var t={},n=0;for(f=0;f<e.length;f++){var r=e[f].attributes,a=r.COMMONNAME;null==t[a]?(n+=1,t[a]=1):t[a]+=1}return n}function nearby_top_func(e){var t={},n=0,r=[null,null,null,null,null,null,null,null];for(nontop8=[],f=0;f<e.length;f++){var a=e[f].attributes,l=a.COMMONNAME;null==t[l]?(n+=1,t[l]=1):t[l]+=1}var i=Object.keys(t);for(s=0;s<i.length;s++)if(spec=i[s],null==r[0]||t[spec]>t[r[0]])for(null!=r[0]&&nontop8.push(r[0]),r[0]=spec,loc=1;loc<8&&(null==r[loc]||t[spec]>t[r[loc]]);){var u=r[loc];r[loc]=spec,r[loc-1]=u,loc+=1}finalsel={};for(var o=0;o<r.length;o++)spec=r[o],null!=spec&&(finalsel[spec]=t[spec]);return Object.keys(finalsel)}function getNearby(e,t,n,r){nbx=e,nby=t,nbr=100,nbif=r,nbdata=n,nearbyHelper(null,[])}function nearbyHelper(e,t){nbr+=200,points=[[nbx-nbr,nby-nbr],[nbx-nbr,nby+nbr],[nbx+nbr,nby+nbr],[nbx+nbr,nby-nbr]],statList=["nearby_top"],null==t&&(t=[]),t.length<8&&2e3>nbr?getStatistics(statList,points,nbdata,nearbyHelper):nbif(nbdata,t)}function functionName(e){var t=e.toString();return t=t.substr("function ".length),t=t.substr(0,t.indexOf("("))}function getStatistics(e,t,n,r,a){console.log("called for "+r+" with statList: "+e+" with injectionFunc: "+functionName(a)),require(["esri/tasks/query","esri/tasks/QueryTask","esri/geometry/Multipoint","esri/SpatialReference"],function(s,l,i,u){var o=new s;queryTask=new l("http://tulip.gis.gatech.edu:6080/arcgis/rest/services/zGT/TreeBasemap/MapServer/1");var f=getOutFuncList(e);o.outFields=f[0],o.returnGeometry=!0,o.spatialRelationship=s.SPATIAL_REL_ENVELOPEINTERSECTS;var c={points:t,spatialReference:{" wkid":4326}},p=new i(c);o.geometry=p;var b=f[1];queryTask.execute(o,function(e){retvals=[];for(var t=0;t<b.length;t++){var s=e.features;retvals.push(b[t](s))}a(r,n,retvals)},function(e){console.log(e)})})}function getOutFuncList(e){for(var t=[],n=[],r=0,a=0;a<e.length;a++){console.log(e),n.push(typeDict[e[a]][0]);var s=typeDict[e[a]][1];for(j=0;j<s.length;j++){var l=s[j];t.push(l)}}return[t,n]}geturl="http://tulip.gis.gatech.edu:6080/arcgis/rest/services/zGT/TreeBasemap/MapServer/1/query?geometry=2228377%2C+1371951%2C+2228477%2C+1372051&geometryType=esriGeometryEnvelope&inSR=&spatialRel=esriSpatialRelIntersects&relationParam=&returnGeometry=false&maxAllowableOffset=&geometryPrecision=&outSR=&returnIdsOnly=false&returnCountOnly=false&orderByFields=&groupByFieldsForStatistics=&outStatistics=&returnZ=false&returnM=false&gdbVersion=&returnDistinctValues=false&f=pjson";var typeDict={tree_count:[tree_count_func,[]],leaf_area:[leaf_area_func,["CanopyRadiusFT"]],total_height:[total_height_func,["TOTHT"]],tree_distribution:[distribution_func,["COMMONNAME"]],num_species:[species_func,["COMMONNAME"]],nearby_top:[nearby_top_func,["COMMONNAME"]]},nbx,nby,nbr,nbdata,nbif;